{"version":3,"file":"pdfparser_cli.js","sources":["../../../src/cli/p2jcliarg.ts","../../../src/cli/p2jcli.ts"],"sourcesContent":[null,null],"names":["pkInfo","_PARSER_SIG","_PRO_TIMER","PDFParser","CLIArgParser","args","aliases","usageMsg","parsedArgv","constructor","Array","isArray","this","usage","alias","key","name","description","showHelp","helpMsg","value","Object","entries","console","log","argv","parseArgv","isNumber","x","test","setArg","val","Number","setKey","split","aliasKey","length","akey","avalue","push","forEach","obj","keys","o","i","undefined","prototype","String","arg","extractKey","match","warn","next","slice","yargs","process","ParserStream","StringifyStream","ONLY_SHOW_VERSION","ONLY_SHOW_HELP","VERBOSITY_LEVEL","HAS_INPUT_DIR_OR_FILE","PROCESS_RAW_TEXT_CONTENT","PROCESS_FIELDS_CONTENT","PROCESS_MERGE_BROKEN_TEXT_BLOCKS","PROCESS_WITH_STREAM","SINGLETON_PDF_PARSER","INPUT_DIR_OR_FILE","f","PDFProcessor","inputDir","inputFile","inputPath","outputDir","outputFile","outputPath","pdfParser","curCLI","path","normalize","join","generateMergedTextBlocksStream","Promise","resolve","reject","outputStream","createOutputStream","replace","getMergedTextBlocksStream","pipe","generateRawTextContentStream","getRawTextContentStream","generateFieldsTypesStream","getAllFieldsTypesStream","processAdditionalStreams","outputTasks","allSettled","onPrimarySuccess","addResultCount","then","retVal","catch","err","onPrimaryError","parseOnePDFStream","on","evtData","parserError","fs","createWriteStream","info","createReadStream","createParserStream","parseOnePDF","writeFile","JSON","stringify","loadPDF","validateParams","existsSync","promises","mkdir","recursive","inExtName","extname","toLowerCase","basename","fod","openSync","closeSync","unlinkSync","destroy","processFile","validateMsg","call","getOutputFile","PDFCLI","inputCount","successCount","failedCount","warningCount","statusMsgs","initialize","version","error","e","Error","message","start","time","inputStatus","statSync","isFile","processOneFile","dirname","isDirectory","processOneDirectory","complete","nextTick","timeEnd","p2j","result","addStatusMsg","ret","status","finally","processFiles","files","allPromises","file","idx","readdir","toString","_iChars","pdfFiles","filter","indexOf","substring","oneMsg"],"mappings":"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"}